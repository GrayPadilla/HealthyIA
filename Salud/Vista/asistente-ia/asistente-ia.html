<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Asistente Alissa - Healthy IA</title>
  <link rel="icon" type="image/jpeg" href="../../imagenes/logo.jpg">
  <link rel="shortcut icon" type="image/jpeg" href="../../imagenes/logo.jpg">
  <link rel="stylesheet" href="asistente-ia.css">
</head>
<body>

  <header>
    <div class="logo">
      <img src="../../imagenes/logo.jpg" alt="Logo">
      <h2>Alissa, tu asistente</h2>
    </div>
    <div class="header-buttons">
      <button type="button" id="darkModeToggle" class="dark-mode-toggle-header" aria-label="Cambiar modo oscuro/claro">
        <span class="toggle-icon">üåô</span>
        <span class="toggle-text">Modo Oscuro</span>
      </button>
      <button id="volverBtn">Volver</button>
    </div>
  </header>

  <main>
    <div class="chat-container" id="chatContainer">
      <div class="ia-message">
        <p id="introText">¬°Hola! Soy <strong>Alissa</strong>. ¬øEn qu√© puedo ayudarte hoy?</p>
      </div>
    </div>

    <div class="input-area">
      <input type="text" id="userInput" placeholder="Escribe tu mensaje aqu√≠...">
      <button id="sendBtn">Enviar</button>
    </div>
  </main>


  <!-- üìä Cargar sistema de m√©tricas primero -->
  <script src="../../Controlador/metricas.js"></script>
  <!-- üîç Cargar servicios de consultas de men√∫s (debe cargarse antes del asistente) -->
  <script type="module" src="../../Controlador/services/menuQueryServiceLoader.js"></script>
  <script src="../../Controlador/C-asistente-ia/config.js"></script>
  <script src="../../Controlador/C-asistente-ia/alissa-smart-copy.js"></script>
  <script>
    // Script para modo oscuro/claro - Ejecutar solo una vez
    (function() {
      if (window.darkModeInitialized) return;
      window.darkModeInitialized = true;
      
      function initDarkMode() {
        const darkModeToggle = document.getElementById('darkModeToggle');
        if (!darkModeToggle) return;
        
        // Remover listeners anteriores si existen
        const newToggle = darkModeToggle.cloneNode(true);
        darkModeToggle.parentNode.replaceChild(newToggle, darkModeToggle);
        
        newToggle.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          document.body.classList.toggle('dark-mode');
          const isDark = document.body.classList.contains('dark-mode');
          const icon = this.querySelector('.toggle-icon');
          const text = this.querySelector('.toggle-text');
          if (icon && text) {
            icon.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
            text.textContent = isDark ? 'Modo Claro' : 'Modo Oscuro';
          }
          localStorage.setItem('darkMode', isDark ? 'enabled' : 'disabled');
        });
        
        const savedMode = localStorage.getItem('darkMode');
        if (savedMode === 'enabled') {
          document.body.classList.add('dark-mode');
          const icon = newToggle.querySelector('.toggle-icon');
          const text = newToggle.querySelector('.toggle-text');
          if (icon && text) {
            icon.textContent = '‚òÄÔ∏è';
            text.textContent = 'Modo Claro';
          }
        }
      }
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initDarkMode);
      } else {
        initDarkMode();
      }
    })();
  </script>
</body>
</html>

